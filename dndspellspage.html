<!DOCTYPE html>
<html lang="eng">
<head>
	<link rel="stylesheet" type="text/css" href="mainstyle.css">
	<meta charset="UTC-8">
	<title>Spell Index</title>
	<meta name="viewport" content="width=device-width">
	<script src="jquery.js"></script>
	<script>
		$(function(){
			$(".submit").click(function(){
				var spell_val = $(".search").val();
				var class_list = $(".spellClass").val();
				var spell_school = [];
				$.each($(".school:checked"), function(){
					spell_school.push($(this).val());
				});
				console.log(spell_school);
				$.post("/myServ/test.php", {spell_name : spell_val, classList : class_list, school : spell_school}, function(data){
					var jsObj = JSON.parse(data);
					var output = ""
					console.log(jsObj);
					if(jsObj == "No Results"){
						output = jsObj;
					}else{
						jsObj.sort(function(a,b){
							return a.spell_name.localeCompare(b.spell_name);
						});
						jsObj.sort(function(a,b){
							return parseFloat(a.spell_level) - parseFloat(b.spell_level);
						});
						for(var i = 0; jsObj.length>i; i++){
							var spell = jsObj[i];
							if (spell.higher_levels == ""){spell.higher_levels = "~"};
							output += "<ul class=lvl"+spell.spell_level+"><li><h3>" + spell.spell_name + "</h3></li><li>" + spell.spell_type + "</li><li>" + spell.casting_time + "</li><li>" + spell.spell_range + "</li><li>" + spell.components +"</li><li>" + spell.duration + "</li><li>" + spell.description + "</li><li>" + spell.higher_levels + "</li></ul>"; 
						};
					};
					$("#spellContent").html(output);
					$(".lvl0:first").before("<h2 class=lvlTitle>Cantrips</h2>");
					$(".lvl1:first").before("<h2 class=lvlTitle>Level One</h2>");
					$(".lvl2:first").before("<h2 class=lvlTitle>Level Two</h2>");
					$(".lvl3:first").before("<h2 class=lvlTitle>Level Three</h2>");
					$(".lvl4:first").before("<h2 class=lvlTitle>Level Four</h2>");
					$(".lvl5:first").before("<h2 class=lvlTitle>Level Five</h2>");
					$(".lvl6:first").before("<h2 class=lvlTitle>Level Six</h2>");
					$(".lvl7:first").before("<h2 class=lvlTitle>Level Seven</h2>");
					$(".lvl8:first").before("<h2 class=lvlTitle>Level Eight</h2>");
					$(".lvl9:first").before("<h2 class=lvlTitle>Level Nine</h2>");
				});
			});
		});
	</script>
</head>
<body>
	<header>
		<h1>Magic Awaits You</h1>
		<nav></nav>
	</header>
	<main class="row">
		<div class="col-3 secondary side">
			<form id="spellForm">
				Type the spell name here, leave blank to search all:
				<input class="search" type="text" name="spell_name" /><br/>
				Choose a specific class spellbook:
				<select class="spellClass">
					<option value="all" selected>All</option>
					<option value="bard">Bard</option>
					<option value="cleric">Cleric</option>
					<option value="druid">Druid</option>
					<option value="paladin">Paladin</option>
					<option value="ranger">Paladin</option>
					<option value="sorcerer">Sorcerer</option>
					<option value="warlock">Warlock</option>
					<option value="wizard">Wizard</option>
				</select>
				<br/><br/>
				<div>
					Search for specific spell schools.<br/>
					<input class="school" type="checkbox" value="abjuration"/>Abjuration<br/>
					<input class="school" type="checkbox" value="conjuration" />Conjuration<br/>
					<input class="school" type="checkbox" value="divination"/>Divination<br/>
					<input class="school" type="checkbox" value="enchantment" />Enchantment<br/>
					<input class="school" type="checkbox" value="evocation" />Evocation<br/>
					<input class="school" type="checkbox" value="illusion" />Illusion<br/>
					<input class="school" type="checkbox" value="necromancy"/>Necromancy<br/>
					<input class="school" type="checkbox" value="transmutation" />Transmutation
				</div>	
					<input class="submit" type="button" value="search"/>
			</form>
		</div>
		<div id="spellContent" class="col-9 tertiary main">

		</div>
	</main>
	<footer>
		Here is where the foot goes.
	</footer>
</body>
</html>